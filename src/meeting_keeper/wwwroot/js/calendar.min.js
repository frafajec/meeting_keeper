function eventHTML(){var e="";e+='<div id="eventForm">',e+='   <input type="text" class="form-control" id="eID-input" style="display: none;" />',e+='<div class="col-md-6"> <div class="form-group">',e+='   <div class="input-group date" id="eStart">',e+='       <span class="input-group-addon"> <span class="glyphicon glyphicon-calendar"></span> </span>',e+='       <label for="eStart-input" class="control-label">Start time</label>',e+='       <input type="text" class="form-control" id="eStart-input" />',e+="   </div>",e+="</div> </div>",e+='<div class="col-md-6"> <div class="form-group">',e+='   <div class="input-group date" id="eEnd">',e+='       <span class="input-group-addon"> <span class="glyphicon glyphicon-calendar"></span> </span>',e+='       <label for="eEnd-input" class="control-label">End time</label>',e+='       <input type="text" class="form-control" id="eEnd-input" />',e+="   </div>",e+="</div> </div>",e+='<div class="col-md-12">',e+='   <div class="form-group">',e+='       <div class="input-group" id="eTitle">',e+='           <label for="eTitle-input" class="control-label">Title</label>',e+='           <input type="text" class="form-control" id="eTitle-input" />',e+="       </div>",e+="   </div>",e+="</div>",e+='<div class="col-md-12">',e+='   <div class="form-group">',e+='       <div class="input-group" id="eDay">',e+='           <label for="eDay-input" class="control-label"> All day event <input type="checkbox" class="form-control" id="eDay-input" /> </label>',e+="       </div>",e+="   </div>",e+="</div>";var t=[{v:"87",c:"#FF4500",n:"orangered"},{v:"106",c:"#A0522D",n:"sienna"},{v:"47",c:"#CD5C5C",n:"indianred"},{v:"17",c:"#008B8B",n:"darkcyan"},{v:"18",c:"#B8860B",n:"darkgoldenrod"},{v:"68",c:"#32CD32",n:"limegreen"},{v:"42",c:"#FFD700",n:"gold"},{v:"77",c:"#48D1CC",n:"mediumturquoise"},{v:"107",c:"#87CEEB",n:"skyblue"},{v:"46",c:"#FF69B4",n:"hotpink"},{v:"47",c:"#CD5C5C",n:"indianred"},{v:"64",c:"#87CEFA",n:"lightskyblue"},{v:"13",c:"#6495ED",n:"cornflowerblue"},{v:"15",c:"#DC143C",n:"crimson"},{v:"24",c:"#FF8C00",n:"darkorange"},{v:"78",c:"#C71585",n:"mediumvioletred"},{v:"123",c:"#000000",n:"black"}];e+='<div class="col-md-12">',e+='   <div class="form-group">',e+='       <div class="input-group" id="eColor">',e+='           <label for="eColor-input" class="control-label">Color</label>',e+='           <select id="eColor-input">';for(var n=0;n<t.length;n++)e+='<option value="'+t[n].v+'" data-color="'+t[n].c+'">'+t[n].n+"</option>";return e+="           </select>",e+="       </div>",e+="   </div>",e+="</div>",e+='<div class="col-md-12">',e+='   <input type="button" id="eDelete-input" />',e+="</div>",e+="</div>"}function formatTime(e){function t(e){return e=parseInt(e),e>10?e:"0"+e}return t(e.getDate())+"."+t(parseInt(e.getMonth())+1)+"."+e.getFullYear()+" "+t(e.getHours())+":"+t(e.getMinutes())}function reformatTime(e){var t=e.split(" ")[0].split(".");return new Date(t[2]+"/"+t[1]+"/"+t[0]+" "+e.split(" ")[1]).toISOString()}function addEvent(e,t){swal({title:"Add event",confrmButtonText:"Add",cancelButtonText:"Cancel",text:eventHTML(),showCancelButton:!0,html:!0,type:"input"},function(e){if(e!==!1){var t=$(".sweet-alert #eventForm"),n={title:t.find("#eTitle-input").val(),start:t.find("#eStart-input").val()?new Date(reformatTime(t.find("#eStart-input").val())).getTime():0,end:t.find("#eEnd-input").val()?new Date(reformatTime(t.find("#eEnd-input").val())).getTime():0,allDay:$("#eDay-input").prop("checked"),color:t.find("#eColor-input option[value="+t.find("#eColor-input").val()+"]").data("color")};$.ajax({url:"Calendar/createEvent",contentType:"application/json; charset=utf-8",dataType:"json",type:"GET",cache:!1,data:{eventJson:JSON.stringify(n)}}).done(function(e){e.start=new Date(e.start).toISOString(),e.end=new Date(e.end).toISOString(),$("#calendar").fullCalendar("renderEvent",e,!0)})}}),$("#calendar").fullCalendar("unselect"),$(".sweet-alert").find("fieldset").hide(),$(".sweet-alert").find("#eDelete-input").hide(),$("#eStart").datetimepicker({format:"DD.MM.YYYY HH:mm",minDate:new Date}),$("#eEnd").datetimepicker({format:"DD.MM.YYYY HH:mm",useCurrent:!1}),$("#eStart").on("dp.change",function(e){$("#eEnd").data("DateTimePicker").minDate(e.date)}),$("#eEnd").on("dp.change",function(e){$("#eStart").data("DateTimePicker").maxDate(e.date)}),$("#eColor-input").colorselector()}function editEvent(e,t){swal({title:"Edit event",confrmButtonText:"Edit",cancelButtonText:"Cancel",text:eventHTML(),showCancelButton:!0,html:!0,type:"input"},function(t,n,a){if(t!==!1){var i=$(".sweet-alert #eventForm"),l={id:parseInt(i.find("#eID-input").val()),title:i.find("#eTitle-input").val(),start:i.find("#eStart-input").val()?new Date(reformatTime(i.find("#eStart-input").val())).getTime():0,end:i.find("#eEnd-input").val()?new Date(reformatTime(i.find("#eEnd-input").val())).getTime():0,allDay:$("#eDay-input").prop("checked"),color:i.find("#eColor-input option[value="+i.find("#eColor-input").val()+"]").data("color")};$.ajax({url:"Calendar/editEvent",contentType:"application/json; charset=utf-8",dataType:"json",type:"GET",cache:!1,data:{eventJson:JSON.stringify(l)}}),e.title=l.title,e.start=new Date(l.start).toISOString(),e.end=new Date(l.end).toISOString(),e.allDay=l.allDay,e.color=l.color,$("#calendar").fullCalendar("updateEvent",e)}}),$("#calendar").fullCalendar("unselect"),$(".sweet-alert").find("fieldset").hide(),$("#eStart").datetimepicker({format:"DD.MM.YYYY HH:mm"}),$("#eEnd").datetimepicker({format:"DD.MM.YYYY HH:mm",useCurrent:!1}),$("#eStart").on("dp.change",function(e){$("#eEnd").data("DateTimePicker").minDate(e.date)}),$("#eEnd").on("dp.change",function(e){$("#eStart").data("DateTimePicker").maxDate(e.date)}),$("#eColor-input").colorselector(),$("#eID-input").val(e.id),$("#eColor-input").colorselector("setColor",e.color),$("#eStart-input").val(formatTime(e.start._d)),$("#eEnd-input").val(e.end?formatTime(e.end._d):""),$("#eTitle-input").val(e.title),$("#eDay-input").prop("checked",e.allDay),$(".sweet-alert").find("#eDelete-input").val("Delete").click(removeEvent)}function removeEvent(){var e=$(".sweet-alert #eventForm"),t={id:parseInt(e.find("#eID-input").val()),title:e.find("#eTitle-input").val(),start:e.find("#eStart-input").val()?new Date(reformatTime(e.find("#eStart-input").val())).getTime():0,end:e.find("#eEnd-input").val()?new Date(reformatTime(e.find("#eEnd-input").val())).getTime():0,allDay:$("#eDay-input").prop("checked"),color:e.find("#eColor-input option[value="+e.find("#eColor-input").val()+"]").data("color")};$.ajax({url:"Calendar/removeEvent",contentType:"application/json; charset=utf-8",dataType:"json",type:"GET",cache:!1,data:{eventJson:JSON.stringify(t)}}).done(function(e){$("#calendar").fullCalendar("removeEvents",[e]),$(".sweet-alert button.cancel").click()})}function settings(){$.ajax({url:"Calendar/getSettings",contentType:"application/json; charset=utf-8",dataType:"json",type:"GET",cache:!1,data:{}}).done(function(e){var t='<div id="settings">';t+='<input type="text" id="hiddenBug" style="display: none;">',t+='<div class="col-md-12">',t+='   <div class="form-group">',t+='       <div class="input-group" id="sSaturday">',t+='           <label for="sSaturday-input" class="control-label"> Show Saturday <input type="checkbox" class="form-control" id="sSaturday-input" /> </label>',t+="       </div>",t+="   </div>",t+="</div>",t+='<div class="col-md-12">',t+='   <div class="form-group">',t+='       <div class="input-group" id="sSunday">',t+='           <label for="sSunday-input" class="control-label"> Show Sunday <input type="checkbox" class="form-control" id="sSunday-input" /> </label>',t+="       </div>",t+="   </div>",t+="</div>",t+="</div>",swal({title:"Calendar settings",confrmButtonText:"Save",cancelButtonText:"Cancel",text:t,showCancelButton:!0,html:!0,type:"input"},function(e){if(e!==!1){var t={showSaturday:$(".sweet-alert").find("#sSaturday-input").prop("checked"),showSunday:$(".sweet-alert").find("#sSunday-input").prop("checked")};$.ajax({url:"Calendar/saveSettings",contentType:"application/json; charset=utf-8",dataType:"json",type:"GET",cache:!1,data:{settingsJSON:JSON.stringify(t)}}).done(function(e){console.log(e)})}}),$("#calendar").fullCalendar("unselect"),$(".sweet-alert").find("fieldset").hide(),-1===e.hiddenDays.indexOf(0)&&$(".sweet-alert").find("#sSunday-input").prop("checked",!0),-1===e.hiddenDays.indexOf(6)&&$(".sweet-alert").find("#sSaturday-input").prop("checked",!0)})}$(document).ready(function(){$.ajax({url:"Calendar/initCalendar",contentType:"application/json; charset=utf-8",dataType:"json",type:"GET",cache:!1,data:{}}).done(function(e){for(var t=0;t<e.events.length;t++)e.events[t].start=new Date(e.events[t].start).toISOString(),e.events[t].end=new Date(e.events[t].end).toISOString();$("#calendar").fullCalendar({timeFormat:"HH:mm",firstDay:e.settings.firstDay,hiddenDays:e.settings.hiddenDays,editable:!0,eventLimit:!0,selectable:!0,selectHelper:!0,select:addEvent,eventClick:editEvent,customButtons:{settings:{text:"Settings",click:settings}},header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay settings"},events:e.events})})});